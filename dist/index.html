<!DOCTYPE html><html><head><meta charset="utf-8"><style>svg#map_chart circle{fill:green;opacity:.5;stroke:#fff}svg .municipality{fill:#efefef;stroke:#fff}svg .municipality-label{fill:#bbb;text-anchor:middle;font-size:12px;font-weight:300}svg #map text{color:#333;text-anchor:middle;font-size:13px}svg #places text{color:#777;text-anchor:start;font:10px sans-serif}rect.bordered{stroke:#e6e6e6;stroke-width:2px}text.mono{fill:#aaa;font-family:Consolas,courier;font-size:9pt}text.axis-workweek{fill:#000}text.axis-noworkweek{fill:red}text.axis-worktime{fill:#2b80ff}text.axis-noworktime{fill:#000}.hour:hover{stroke:#333;stroke-width:2px}.links line{stroke:#999;stroke-opacity:.6}.nodes circle{stroke:#fff;stroke-width:1.5px}text{font-family:sans-serif;font-size:10px}.tooltip{z-index:zindex-tooltip;margin:tooltip-margin;font-size:tooltip-font-size;word-wrap:break-word;opacity:0;display:block;position:absolute;&.show{opacity:tooltip-opacity}& .arrow{width:tooltip-arrow-width;height:tooltip-arrow-height;display:block;position:absolute;&:before{content:"";border-style:solid;border-color:#0000;position:absolute}}}#network_chart>g,#map_chart #map_circle,#heatmap rect{cursor:pointer}</style></head><body> <div id="top" width="500" height="50"> <h2 id="top_title">따릉이 이용 HotSpot 분석</h2> </div> <div id="part1"> <div><p>#HotSpot은 어디!? 언제!? 누구에게!?</p></div> <svg id="map_chart"/> <svg id="right_chart"/> </div> <div><p>#따릉이 HotSpot Top10</p></div> <svg id="bubble_chart"/> <div><p>#따릉이 HotSpot에서의 이동</p></div> <svg id="network_chart"/> <script src="http://d3js.org/d3.v3.min.js"></script> <script src="http://d3js.org/topojson.v1.min.js"></script> <script src="https://d3js.org/d3.v4.js"></script> <script src="https://d3js.org/d3.v3.js"></script> <script src="/index.90d1c477.js"></script> <script>var t="합계",e=600,a=450,r=d3.select("#map_chart").attr("width",e).attr("height",a),n=r.append("g").attr("id","map"),c=r.append("g").attr("id","places"),d=d3.geo.mercator().center([126.9895,37.5651]).scale(7e4).translate([e/2,a/2]),f=d3.geo.path().projection(d);d3.json("/data/seoul_municipalities_topo_simple.json",function(t,e){var a=topojson.feature(e,e.objects.seoul_municipalities_geo).features;n.selectAll("path").data(a).enter().append("path").attr("class",function(t){return console.log(),"municipality c"+t.properties.code}).attr("d",f),n.selectAll("text").data(a).enter().append("text").attr("transform",function(t){return"translate("+f.centroid(t)+")"}).attr("dy",".35em").attr("class","municipality-label").text(function(t){return t.properties.SIG_KOR_NM})});var l=d3.select("body").append("div").attr("class","tooltip").style("opacity",1).style("background-color","white").style("border","solid").style("border-width","2px").style("border-radius","5px").style("padding","5px"),o=function(t){l.style("opacity",1)},i=function(t){l.html("<b>"+t.name+"</b><br><img src="+t.photo+" width=250 height=160 ></img>").style("left",d3.mouse(this)[0]+10+"px").style("top",d3.mouse(this)[1]+"px"),4!=t.size&&l.style("opacity",0)},s=function(t){l.style("opacity",0)};d3.csv("./data/newplace.csv",function(t){c.selectAll("circle").data(t).enter().append("circle").attr("id","map_circle").attr("cx",function(t){return d([t.lon,t.lat])[0]}).attr("cy",function(t){return d([t.lon,t.lat])[1]}).attr("r",function(t){return t.size}).style("fill",function(t){return t.color}).on("mouseover",o).on("mousemove",i).on("mouseleave",s),c.selectAll("text").data(t).enter().append("text").attr("x",function(t){return d([t.lon,t.lat])[0]}).attr("y",function(t){return d([t.lon,t.lat])[1]+8}).text(function(t){return t.name2})}),d3.select("#right_chart").attr("width",600).attr("height",500);var u=function(){var e=["10대","20대","30대","40대","50대","60대 이상"],a=d3.select("#right_chart").append("g").attr("id","pie_chart").attr("transform","translate(250,150)"),r=d3.scale.ordinal().range(["#D3F500","#A1F20C","#1ADB00","#0CF259","#0CE8B4","#00C5EB"]),n=a.append("g").attr("transform","translate(40, 10)"),c=d3.svg.arc().innerRadius(40).outerRadius(100);d3.csv("./data/age_pie.csv",function(a){data2=a.filter(e=>e.name==t);var d=d3.layout.pie().value(function(t){return t.value}),f=n.selectAll(".arc").data(d(data2)).enter().append("g").attr("class","arc");f.append("path").attr("d",c).attr("fill",function(t){return r(t.value)}),f.append("text").attr("transform",function(t,e){return e<4?"translate("+c.centroid(t)+")":"translate("+c.centroid(t)+") rotate(90) "}).attr("text-anchor","middle").attr("font-size","0.8em").text(function(t,a){return e[a]})})};u();var e=530,a=80,b=Math.floor(22.083333333333332),p=["#ffffe5","#ffffe4","#feffe2","#feffe1","#feffdf","#feffde","#fdfedd","#fdfedb","#fdfeda","#fdfed9","#fcfed7","#fcfed6","#fcfed5","#fbfed3","#fbfed2","#fbfdd1","#fbfdcf","#fafdce","#fafdcd","#f9fdcc","#f9fdca","#f9fdc9","#f8fcc8","#f8fcc7","#f7fcc5","#f7fcc4","#f6fcc3","#f6fcc2","#f5fbc1","#f5fbc0","#f4fbbf","#f4fbbe","#f3fabd","#f3fabc","#f2fabb","#f1faba","#f1f9b9","#f0f9b8","#eff9b7","#eff9b6","#eef8b5","#edf8b4","#ecf8b3","#ebf7b2","#ebf7b2","#eaf7b1","#e9f6b0","#e8f6af","#e7f6ae","#e6f5ae","#e5f5ad","#e4f4ac","#e3f4ab","#e2f4ab","#e1f3aa","#e0f3a9","#dff2a8","#def2a8","#ddf2a7","#dcf1a6","#dbf1a6","#daf0a5","#d9f0a4","#d8efa4","#d6efa3","#d5eea2","#d4eea2","#d3eda1","#d2eda0","#d0eca0","#cfec9f","#ceeb9e","#cdeb9e","#cbea9d","#caea9c","#c9e99c","#c7e89b","#c6e89a","#c5e79a","#c3e799","#c2e698","#c1e598","#bfe597","#bee496","#bde496","#bbe395","#bae294","#b8e294","#b7e193","#b5e192","#b4e092","#b2df91","#b1df90","#afde90","#aedd8f","#acdd8e","#abdc8e","#a9db8d","#a8db8c","#a6da8c","#a5d98b","#a3d98a","#a2d88a","#a0d789","#9ed788","#9dd688","#9bd587","#9ad586","#98d486","#96d385","#95d284","#93d284","#92d183","#90d082","#8ed082","#8dcf81","#8bce80","#89cd80","#88cd7f","#86cc7e","#84cb7d","#83ca7d","#81ca7c","#7fc97b","#7ec87a","#7cc77a","#7ac779","#79c678","#77c577","#75c477","#73c376","#72c375","#70c274","#6ec174","#6dc073","#6bbf72","#69be71","#68be70","#66bd6f","#64bc6f","#63bb6e","#61ba6d","#5fb96c","#5eb96b","#5cb86a","#5ab76a","#59b669","#57b568","#56b467","#54b366","#53b265","#51b164","#50b064","#4eaf63","#4dae62","#4bad61","#4aac60","#48ab5f","#47aa5e","#46a95e","#44a85d","#43a75c","#42a65b","#40a55a","#3fa459","#3ea359","#3da258","#3ca157","#3aa056","#399f55","#389d55","#379c54","#369b53","#359a52","#349951","#339851","#329750","#31964f","#30944e","#2f934e","#2e924d","#2d914c","#2c904b","#2a8f4b","#298e4a","#288d49","#278b49","#268a48","#258947","#248847","#238746","#228645","#218545","#208444","#1f8344","#1e8243","#1d8143","#1c8042","#1b7f42","#1a7e41","#197d41","#187c40","#177b40","#167a3f","#15793f","#14783e","#13773e","#12763d","#11753d","#10743c","#10733c","#0f723c","#0e723b","#0d713b","#0c703a","#0b6f3a","#0b6e3a","#0a6d39","#096c39","#086b38","#086a38","#076938","#066837","#066737","#056636","#056536","#046435","#046335","#046235","#036134","#036034","#025f33","#025e33","#025d33","#025c32","#015b32","#015a31","#015931","#015730","#015630","#015530","#00542f","#00532f","#00522e","#00512e","#00502d","#004f2d","#004e2d","#004d2c","#004c2c","#004a2b","#00492b","#00482a","#00472a","#004629","#004529"],m=d3.select("#right_chart").append("g").attr("id","heatmap").attr("transform","translate(30,300)");m.selectAll(".dayLabel").data(["월","화","수","목","금","토","일"]).enter().append("text").text(function(t){return t}).attr("x",0).attr("y",function(t,e){return e*b}).style("text-anchor","end").attr("transform","translate(-6,"+b/1.5+")").attr("class",function(t,e){return e>=0&&e<=4?"dayLabel mono axis axis-workweek":"dayLabel mono axis-noworkweek"}),m.selectAll(".timeLabel").data(["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24"]).enter().append("text").text(function(t){return t}).attr("x",function(t,e){return e*b}).attr("y",0).style("text-anchor","middle").attr("transform","translate("+b/2+", -6)").attr("class",function(t,e){return e>=7&&e<=16?"timeLabel mono axis axis-worktime":"timeLabel mono axis-noworktime"});var y=function(){d3.csv("./data/top10_요일별_시간대별_이용건수_heatmap.csv",function(e){data2=e.filter(e=>e.place==t);var a=d3.select("body").append("div").style("opacity",0).attr("class","tooltip").style("background-color","white").style("border","solid").style("border-width","2px").style("border-radius","5px").style("padding","5px"),r=d3.scale.quantile().domain([0,d3.max(data2,function(t){return t.value})]).range(p),n=m.selectAll(".hour").data(data2,function(t){return t.day+":"+t.time});n.append("title"),n.enter().append("rect").attr("x",function(t){return(t.time-1)*b}).attr("y",function(t){return(t.day-1)*b}).attr("rx",4).attr("ry",4).attr("class","hour bordered").attr("width",b).attr("height",b).style("fill",p[0]).on("mouseover",function(t){a.style("opacity",1)}).on("mousemove",function(t){a.html(t.요일+" "+t.time+"시<br>이용건수 : "+t.value+"건").style("left",600+d3.mouse(this)[0]+"px").style("top",350+d3.mouse(this)[1]+"px")}).on("mouseleave",function(t){a.style("opacity",0)}),n.transition().duration(1e3).style("fill",function(t){return r(t.value)}),n.exit().remove()})};t="합계",y();var x=d3.select("#bubble_chart").attr("width",1250).attr("height",200).append("g").attr("transform","translate(0,10)");d3.csv("./data/rank.csv",function(e){var a=d3.scale.linear().domain([0,10]).range([0,1200]),r=d3.scale.linear().domain([0,2]).range([150,0]),n=d3.scale.linear().domain([0,2800]).range([1,10]),c=["#e8f6f9","#d5efed","#b7e4da","#8fd3c1","#68c2a3","#49b17f","#2f9959","#157f3c","#036429","#00441b"],d=x.append("g").selectAll("dot").data(e).enter(),f=d.append("circle").attr("id","b_circle").attr("cx",function(t){return 1==t.value?a(.6):a(.1+.9*t.rank)}).attr("cy",function(t){return r(1)}).attr("r",function(t){return 5*n(t.value)}).style("fill",function(t,e){return c[9-e]}).style("opacity","0.8").style("stroke","darkgreen").style("stroke-width","1px");f.on("click",function(e){d3.selectAll("#b_text").text(""),f.attr("r",function(t){return t.rank==e.rank?6*n(t.value):5*n(t.value)}),f.style("stroke-width",function(t){return t.rank==e.rank?2:1}),d3.selectAll("#map_circle").attr("r",function(t){return t.name==e.name?13:t.size}),d.append("text").attr("id","b_text").attr("text-anchor","middle").attr("x",function(t){return a(.1+.9*t.rank)}).attr("y",150).text(function(t){if(t.rank==e.rank)return t.name}),t=e.name,u(),y()}).on("mouseout",function(){d3.selectAll("#b_circle").attr("r",function(t){return 5*n(t.value)}),d3.selectAll("#b_circle").style("stroke-width",1),d3.selectAll("#map_circle").attr("r",function(t){return t.size})}),d.append("text").style("text-anchor","middle").attr("x",function(t){return a(.1+.9*t.rank)}).attr("y",75).attr("fill","black").text(function(t,e){return t.rank+"위"}).style("text-size","20px")});</script> <script src="https://d3js.org/d3.v4.js"></script> <script>var t=d3.select("#network_chart");t.attr("width",1200).attr("height",500),t.attr("transform","translate(0,50)"),t.append("text").text("Circle에 마우스 커서를 갖다 대면 대여소명이 보여요!").attr("transform","translate(30,50)");var n=["lightgray","#31a354","#fdea45"],r=["#e8f6f9","#d5efed","#b7e4da","#8fd3c1","#68c2a3","#49b17f","#2f9959","#157f3c","#036429","#00441b"],e=d3.forceSimulation().force("link",d3.forceLink().id(function(t){return t.id}).distance(50).strength(.6)).force("charge",d3.forceManyBody().strength(-50)).force("center",d3.forceCenter(width/2+200,height/2+200)).force("collide",d3.forceCollide(function(t){var n=t.UnKnown/t.Known*6;return isNaN(n)?0:n}));function a(t){d3.event.active||e.alphaTarget(.3).restart(),t.fx=t.x,t.fy=t.y}function o(t){t.fx=d3.event.x,t.fy=d3.event.y}function i(t){d3.event.active||e.alphaTarget(0),t.fx=null,t.fy=null}d3.json("./data/miserables.json",function(c,d){if(c)throw c;var l=t.append("g").attr("class","links").attr("transform","translate(0,50)").selectAll("line").data(d.links).enter().append("line").attr("stroke-width",function(t){return Math.sqrt(t.value)}),u=t.append("g").attr("class","nodes").attr("transform","translate(0,50)").selectAll("g").data(d.nodes).enter().append("g").on("mouseover",function(t){d3.select(this).select("circle").transition().duration(300).attr("r",18)}).on("mouseout",function(t){d3.select(this).select("circle").transition().duration(150).attr("r",function(t){return 0==t.group?"12":1==t.group?"15":"8"})});u.append("title").text(function(t){return t.id}),u.append("circle").attr("r",function(t){return 0==t.group?"12":1==t.group?"15":"8"}).style("stroke",function(t){return 1==t.group?"darkgreen":0==t.group?"lightgray":void 0}).style("stroke-width",function(t){if(1==t.group)return .5}).style("fill",function(t){return 1==t.group?r[10-t.rank]:n[t.group]}).call(d3.drag().on("start",a).on("drag",o).on("end",i)),e.nodes(d.nodes).on("tick",function(){l.attr("x1",function(t){return t.source.x}).attr("y1",function(t){return t.source.y}).attr("x2",function(t){return t.target.x}).attr("y2",function(t){return t.target.y}),u.attr("transform",function(t){return"translate("+t.x+","+t.y+")"})}),e.force("link").links(d.links)}),legend_data=["Hotspot","Hotspot Top10 대여소","Hotspot <-> 대여소"];var c=t.append("g").attr("id","legend").attr("text-anchor","end").selectAll("g.legend").data(legend_data).enter().append("g").attr("id",function(t,n){return"legend"+n}).attr("transform",function(t,n){return"translate(800, "+(20*n+0+30)+")"});c.append("circle").attr("x",width-20).attr("r",8).style("fill",function(t,r){return n[r]}),c.append("text").attr("text-anchor","start").text(function(t,n){return t});</script> </body></html>